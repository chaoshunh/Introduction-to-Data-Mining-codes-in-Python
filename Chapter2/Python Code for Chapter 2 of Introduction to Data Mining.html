<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Python Code for Chapter 2 of Introduction to Data Mining</title>
</head>
<body>
<div id="wmd-preview" class="wmd-preview"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="t4l5" id="python-code-for-chapter-2-of-introduction-to-data-mining">Python Code for Chapter 2 of Introduction to Data Mining</h1><hr><div class="md-section-divider"></div><h3 data-anchor-id="1gyi" id="1data-preparation">1.Data Preparation</h3><p data-anchor-id="bzul">Load necessary packages.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="p5t7" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="lit">@Load</span><span class="pln"> packages</span></code></li><li class="L1"><code class="language-python"><span class="kwd">import</span><span class="pln"> pandas </span><span class="kwd">as</span><span class="pln"> pd</span></code></li><li class="L2"><code class="language-python"><span class="kwd">from</span><span class="pln"> pandas </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Series</span><span class="pun">,</span><span class="typ">DataFrame</span></code></li><li class="L3"><code class="language-python"><span class="kwd">import</span><span class="pln"> numpy </span><span class="kwd">as</span><span class="pln"> np</span></code></li><li class="L4"><code class="language-python"><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">datasets </span><span class="kwd">import</span><span class="pln"> load_iris</span></code></li><li class="L5"><code class="language-python"><span class="kwd">import</span><span class="pln"> matplotlib</span><span class="pun">.</span><span class="pln">pyplot </span><span class="kwd">as</span><span class="pln"> plt</span></code></li><li class="L6"><code class="language-python"><span class="kwd">import</span><span class="pln"> seaborn </span><span class="kwd">as</span><span class="pln"> sns</span></code></li></ol></pre><p data-anchor-id="1hpk">Load Iris dataset and store it in a dateframe.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="rtky" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">data</span><span class="pun">=</span><span class="pln">load_iris</span><span class="pun">()</span></code></li><li class="L1"><code class="language-python"><span class="pln">data</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">shape</span><span class="pun">=(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">data</span><span class="pun">.</span><span class="pln">data</span><span class="pun">),</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"><span class="com">#concatenate the target column and the feature columns</span></code></li><li class="L3"><code class="language-python"><span class="pln">new_data</span><span class="pun">=</span><span class="pln">np</span><span class="pun">.</span><span class="pln">concatenate</span><span class="pun">((</span><span class="pln">data</span><span class="pun">.</span><span class="pln">data</span><span class="pun">,</span><span class="pln">data</span><span class="pun">.</span><span class="pln">target</span><span class="pun">),</span><span class="pln">axis</span><span class="pun">=</span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L4"><code class="language-python"><span class="pln">iris</span><span class="pun">=</span><span class="pln">pd</span><span class="pun">.</span><span class="typ">DataFrame</span><span class="pun">(</span><span class="pln">new_data</span><span class="pun">,</span><span class="pln">columns</span><span class="pun">=[</span><span class="str">'sepal_length'</span><span class="pun">,</span><span class="str">'sepal_width'</span><span class="pun">,</span><span class="str">'petal_length'</span><span class="pun">,</span><span class="str">'petal_width'</span><span class="pun">,</span><span class="str">'target'</span><span class="pun">])</span></code></li></ol></pre><p data-anchor-id="y2dw">Let us take a look at the iris dataframe.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="lpi7" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">head</span><span class="pun">(</span><span class="lit">10</span><span class="pun">))</span></code></li></ol></pre><p data-anchor-id="cd0z"><img src="http://static.zybuluo.com/catMemory/f4h3vzxwr6emsh2ytnvjhmwq/%E6%8D%95%E8%8E%B7.PNG" alt="捕获.PNG-6.9kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="z4er" id="2-data-quality">2. Data Quality</h3><p data-anchor-id="yozo">Check the basic statistics of iris dataset.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="2vxh" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">info</span><span class="pun">())</span></code></li><li class="L1"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">describe</span><span class="pun">())</span></code></li></ol></pre><p data-anchor-id="prdd">Note that no missing values in iris dataset.</p><p data-anchor-id="ga5r"><img src="http://static.zybuluo.com/catMemory/1ykhwbhmg379g8o603eqowai/%E6%8D%95%E8%8E%B7.PNG" alt="捕获.PNG-7.5kB"></p><p data-anchor-id="azs3"><img src="http://static.zybuluo.com/catMemory/jn3nlbj1py8cn4lkxwc9x4sy/%E6%8D%95%E8%8E%B7.PNG" alt="捕获.PNG-7.2kB"></p><p data-anchor-id="1czv">Inspect the scattter matrix plot of iris dataset.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="3w2o" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="com">#The scatter-matrix of iris</span></code></li><li class="L1"><code class="language-python"><span class="pln">sns</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="pln">style</span><span class="pun">=</span><span class="str">"ticks"</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"><span class="pln">sns</span><span class="pun">.</span><span class="pln">pairplot</span><span class="pun">(</span><span class="pln">iris</span><span class="pun">,</span><span class="pln">hue</span><span class="pun">=</span><span class="str">"target"</span><span class="pun">)</span></code></li><li class="L3"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">savefig</span><span class="pun">(</span><span class="str">"Scatter Matrix.png"</span><span class="pun">)</span></code></li><li class="L4"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">show</span><span class="pun">()</span></code></li></ol></pre><p data-anchor-id="ap8v"><img src="http://static.zybuluo.com/catMemory/rr16ze9k10rdselk1n8wfv5f/Scatter%20Matrix.png" alt="Scatter Matrix.png-192.7kB"></p><p data-anchor-id="w37c">Check the duplicated rows and remove them.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="lb6v" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="str">'number of duplicated:'</span><span class="pun">,</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">duplicated</span><span class="pun">().</span><span class="pln">sum</span><span class="pun">())</span></code></li><li class="L1"><code class="language-python"><span class="pln">iris</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">drop_duplicates</span><span class="pun">()</span></code></li></ol></pre><p data-anchor-id="eucl"><img src="http://static.zybuluo.com/catMemory/vrk8d9nh2x4v32wgvebmt4l2/%E6%8D%95%E8%8E%B7.PNG" alt="捕获.PNG-0.6kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="mj2p" id="3-aggregation">3. Aggregation</h3><p data-anchor-id="l6xc">Aggregate by species using mean.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="xodo" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">grouped_mean</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">groupby</span><span class="pun">(</span><span class="str">'target'</span><span class="pun">).</span><span class="pln">mean</span><span class="pun">()</span></code></li><li class="L1"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">grouped_mean</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="zur2"><img src="http://static.zybuluo.com/catMemory/gwkq90wqbysd3jhuzy8y4jco/%E6%8D%95%E8%8E%B7.PNG" alt="捕获.PNG-3.6kB"></p><p data-anchor-id="d0vz">Aggregate by species using mean.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="bqo5" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">grouped_median</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">groupby</span><span class="pun">(</span><span class="str">'target'</span><span class="pun">).</span><span class="pln">median</span><span class="pun">()</span></code></li><li class="L1"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">grouped_median</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="v002"><img src="http://static.zybuluo.com/catMemory/figvnyn8bg9jkjfr4nhmssvf/%E6%8D%95%E8%8E%B7.PNG" alt="捕获.PNG-3.7kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="4avi" id="4-random-sampling">4. Random Sampling</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="xkc1" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">random_sampled</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">take</span><span class="pun">(</span><span class="pln">np</span><span class="pun">.</span><span class="pln">random</span><span class="pun">.</span><span class="pln">permutation</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">iris</span><span class="pun">))[:</span><span class="lit">20</span><span class="pun">])</span></code></li><li class="L1"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">random_sampled</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="pgja"><img src="http://static.zybuluo.com/catMemory/fq8ky050pvum7fncckhdnqn9/%E6%8D%95%E8%8E%B7.PNG" alt="捕获.PNG-11.1kB"></p><p data-anchor-id="6ijv">Scatter plot on sampling dataset.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="bz28" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">sns</span><span class="pun">.</span><span class="pln">set</span><span class="pun">(</span><span class="pln">style</span><span class="pun">=</span><span class="str">"ticks"</span><span class="pun">)</span></code></li><li class="L1"><code class="language-python"><span class="pln">sns</span><span class="pun">.</span><span class="pln">pairplot</span><span class="pun">(</span><span class="pln">random_sampled</span><span class="pun">,</span><span class="pln">hue</span><span class="pun">=</span><span class="str">"target"</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">savefig</span><span class="pun">(</span><span class="str">'sampling'</span><span class="pun">)</span></code></li><li class="L3"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">show</span><span class="pun">()</span></code></li></ol></pre><p data-anchor-id="6w2d"><img src="http://static.zybuluo.com/catMemory/snmw2pr6h6pm4kow4058lekw/sampling.png" alt="sampling.png-81.7kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="khvk" id="5-dimensionality-reduction-principal-components-analysis-pca">5. Dimensionality reduction (Principal Components Analysis - PCA)</h3><p data-anchor-id="au4p">Plot 3D scatter plot for the first three features.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="4b6x" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">from</span><span class="pln"> mpl_toolkits</span><span class="pun">.</span><span class="pln">mplot3d </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Axes3D</span></code></li><li class="L1"><code class="language-python"><span class="pln">fig</span><span class="pun">=</span><span class="pln">plt</span><span class="pun">.</span><span class="pln">figure</span><span class="pun">()</span></code></li><li class="L2"><code class="language-python"><span class="pln">ax</span><span class="pun">=</span><span class="typ">Axes3D</span><span class="pun">(</span><span class="pln">fig</span><span class="pun">)</span></code></li><li class="L3"><code class="language-python"><span class="pln">colors</span><span class="pun">=[</span><span class="str">'red'</span><span class="pun">,</span><span class="str">'k'</span><span class="pun">,</span><span class="str">'blue'</span><span class="pun">]</span></code></li><li class="L4"><code class="language-python"><span class="pln">x_vals</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">sepal_length</span><span class="pun">;</span><span class="pln"> y_vals</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">sepal_width</span><span class="pun">;</span><span class="pln"> z_vals</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">petal_length</span></code></li><li class="L5"><code class="language-python"><span class="pln">ax</span><span class="pun">.</span><span class="pln">scatter</span><span class="pun">(</span><span class="pln">x_vals</span><span class="pun">,</span><span class="pln">y_vals</span><span class="pun">,</span><span class="pln">z_vals</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> x</span><span class="pun">:</span><span class="pln"> colors</span><span class="pun">[</span><span class="pln">int</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)]))</span></code></li><li class="L6"><code class="language-python"><span class="pln">ax</span><span class="pun">.</span><span class="pln">set_xlabel</span><span class="pun">(</span><span class="str">'sepal_length'</span><span class="pun">)</span></code></li><li class="L7"><code class="language-python"><span class="pln">ax</span><span class="pun">.</span><span class="pln">set_ylabel</span><span class="pun">(</span><span class="str">'sepal_width'</span><span class="pun">)</span></code></li><li class="L8"><code class="language-python"><span class="pln">ax</span><span class="pun">.</span><span class="pln">set_zlabel</span><span class="pun">(</span><span class="str">'petal_length'</span><span class="pun">)</span></code></li><li class="L9"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">show</span><span class="pun">()</span></code></li></ol></pre><p data-anchor-id="x7yh"><img src="http://static.zybuluo.com/catMemory/fjoaixkxjcsodazu3k0rggcj/Figure_3.png" alt="Figure_3.png-87.1kB"></p><p data-anchor-id="qug7">Find the suitable components for PCA.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="0yfq" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="kwd">from</span><span class="pln"> sklearn</span><span class="pun">.</span><span class="pln">decomposition </span><span class="kwd">import</span><span class="pln"> PCA</span></code></li><li class="L1"><code class="language-python"><span class="pln">pca</span><span class="pun">=</span><span class="pln">PCA</span><span class="pun">()</span></code></li><li class="L2"><code class="language-python"><span class="pln">pca</span><span class="pun">.</span><span class="pln">fit</span><span class="pun">(</span><span class="pln">iris</span><span class="pun">)</span></code></li><li class="L3"><code class="language-python"><span class="kwd">print</span><span class="pun">(</span><span class="pln">pca</span><span class="pun">.</span><span class="pln">explained_variance_ratio_</span><span class="pun">)</span><span class="pln"> </span></code></li></ol></pre><p data-anchor-id="dvie">Note that only the first dimension matters, but in this example we consider the first two dimensions. <br>
<img src="http://static.zybuluo.com/catMemory/cnkq51z1oj1fkz1ak7zdyqsg/%E6%8D%95%E8%8E%B7.PNG" alt="捕获.PNG-1.3kB"></p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="yu31" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">pca</span><span class="pun">.</span><span class="pln">n_components</span><span class="pun">=</span><span class="lit">2</span></code></li><li class="L1"><code class="language-python"><span class="pln">iris_reduced</span><span class="pun">=</span><span class="pln">pca</span><span class="pun">.</span><span class="pln">fit_transform</span><span class="pun">(</span><span class="pln">iris</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="47gu">Plot the scatter of new reduced dataset.</p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="y92i" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">fig</span><span class="pun">=</span><span class="pln">plt</span><span class="pun">.</span><span class="pln">figure</span><span class="pun">()</span></code></li><li class="L1"><code class="language-python"><span class="pln">ax1</span><span class="pun">=</span><span class="pln">fig</span><span class="pun">.</span><span class="pln">add_subplot</span><span class="pun">(</span><span class="lit">111</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"><span class="pln">x_val</span><span class="pun">=</span><span class="pln">iris_reduced</span><span class="pun">[:,</span><span class="lit">0</span><span class="pun">];</span><span class="pln">y_val</span><span class="pun">=</span><span class="pln">iris_reduced</span><span class="pun">[:,</span><span class="lit">1</span><span class="pun">]</span></code></li><li class="L3"><code class="language-python"><span class="pln">colors</span><span class="pun">=[</span><span class="str">'red'</span><span class="pun">,</span><span class="str">'k'</span><span class="pun">,</span><span class="str">'blue'</span><span class="pun">]</span></code></li><li class="L4"><code class="language-python"><span class="pln">ax1</span><span class="pun">.</span><span class="pln">scatter</span><span class="pun">(</span><span class="pln">x_val</span><span class="pun">,</span><span class="pln">y_val</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">target</span><span class="pun">.</span><span class="pln">apply</span><span class="pun">(</span><span class="kwd">lambda</span><span class="pln"> x</span><span class="pun">:</span><span class="pln">colors</span><span class="pun">[</span><span class="pln">int</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)]))</span></code></li><li class="L5"><code class="language-python"><span class="pln">ax1</span><span class="pun">.</span><span class="pln">set_xlabel</span><span class="pun">(</span><span class="str">'Component1'</span><span class="pun">)</span></code></li><li class="L6"><code class="language-python"><span class="pln">ax1</span><span class="pun">.</span><span class="pln">set_ylabel</span><span class="pun">(</span><span class="str">'Component2'</span><span class="pun">)</span></code></li></ol></pre><p data-anchor-id="gcs3"><img src="http://static.zybuluo.com/catMemory/fkpfjv9tal96wttojqh6bdpv/Figure_4.png" alt="Figure_4.png-34.8kB"></p><div class="md-section-divider"></div><h3 data-anchor-id="bwvo" id="6-correlation-matrix">6 Correlation Matrix</h3><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="lsma" style=""><ol class="linenums"><li class="L0"><code class="language-python"><span class="pln">correlation_matrix</span><span class="pun">=</span><span class="pln">iris</span><span class="pun">.</span><span class="pln">corr</span><span class="pun">()</span></code></li><li class="L1"><code class="language-python"><span class="pln">mask </span><span class="pun">=</span><span class="pln"> np</span><span class="pun">.</span><span class="pln">zeros_like</span><span class="pun">(</span><span class="pln">correlation_matrix</span><span class="pun">,</span><span class="pln"> dtype</span><span class="pun">=</span><span class="pln">np</span><span class="pun">.</span><span class="pln">bool</span><span class="pun">)</span></code></li><li class="L2"><code class="language-python"><span class="pln">mask</span><span class="pun">[</span><span class="pln">np</span><span class="pun">.</span><span class="pln">triu_indices_from</span><span class="pun">(</span><span class="pln">mask</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">True</span></code></li><li class="L3"><code class="language-python"><span class="pln">f</span><span class="pun">,</span><span class="pln"> ax </span><span class="pun">=</span><span class="pln"> plt</span><span class="pun">.</span><span class="pln">subplots</span><span class="pun">(</span><span class="pln">figsize</span><span class="pun">=(</span><span class="lit">11</span><span class="pun">,</span><span class="pln"> </span><span class="lit">9</span><span class="pun">))</span></code></li><li class="L4"><code class="language-python"><span class="pln">cmap </span><span class="pun">=</span><span class="pln"> sns</span><span class="pun">.</span><span class="pln">diverging_palette</span><span class="pun">(</span><span class="lit">220</span><span class="pun">,</span><span class="pln"> </span><span class="lit">10</span><span class="pun">,</span><span class="pln"> as_cmap</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span></code></li><li class="L5"><code class="language-python"><span class="pln">sns</span><span class="pun">.</span><span class="pln">heatmap</span><span class="pun">(</span><span class="pln">correlation_matrix</span><span class="pun">,</span><span class="pln"> mask</span><span class="pun">=</span><span class="pln">mask</span><span class="pun">,</span><span class="pln"> cmap</span><span class="pun">=</span><span class="pln">cmap</span><span class="pun">,</span><span class="pln"> vmax</span><span class="pun">=.</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> center</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span></code></li><li class="L6"><code class="language-python"><span class="pln">            square</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">,</span><span class="pln"> ax</span><span class="pun">=</span><span class="pln">ax</span><span class="pun">)</span></code></li><li class="L7"><code class="language-python"><span class="pln">plt</span><span class="pun">.</span><span class="pln">show</span><span class="pun">()</span></code></li></ol></pre><p data-anchor-id="2aka"><img src="http://static.zybuluo.com/catMemory/xwrlh7galtr785i72pf114mi/corr.png" alt="corr.png-24.4kB"></p><div class="md-section-divider"></div><h4 data-anchor-id="3bd5" id="to-be-continued">To be continued.....</h4></div>
</body>
</html>